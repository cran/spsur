<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Fernando A. López, Technical University of Cartagena (Spain)" />
<meta name="author" content="Román Mínguez, University of Castilla-La Mancha (Spain)" />
<meta name="author" content="Jesús Mur, University of Zaragoza, (Spain)      " />

<meta name="date" content="2022-10-29" />

<title>Spatial seemingly unrelated regression models. A comparison of spsur, spse and PySAL</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Spatial seemingly unrelated regression
models. A comparison of spsur, spse and PySAL</h1>
<h4 class="author">Fernando A. López, Technical University of Cartagena
(Spain)</h4>
<h4 class="author">Román Mínguez, University of Castilla-La Mancha
(Spain)</h4>
<h4 class="author">Jesús Mur, University of Zaragoza, (Spain) <br> <br>
<br></h4>
<h4 class="date">2022-10-29 <br> <br> <br></h4>


<div id="TOC">
<ul>
<li><a href="#Intro" id="toc-Intro"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#SUR-SIM" id="toc-SUR-SIM"><span class="toc-section-number">2</span> The SUR-SIM model</a></li>
<li><a href="#estimation-of-sur-sem" id="toc-estimation-of-sur-sem"><span class="toc-section-number">3</span>
Estimation of SUR-SEM</a></li>
<li><a href="#estimation-of-sur-slm" id="toc-estimation-of-sur-slm"><span class="toc-section-number">4</span>
Estimation of SUR-SLM</a></li>
<li><a href="#conclusion" id="toc-conclusion"><span class="toc-section-number">5</span> Conclusion</a></li>
<li><a href="#Appendix" id="toc-Appendix"><span class="toc-section-number">6</span> Appendix</a>
<ul>
<li><a href="#full-results-sur-sim" id="toc-full-results-sur-sim"><span class="toc-section-number">6.1</span> Full results SUR-SIM</a></li>
<li><a href="#full-results-sur-sem" id="toc-full-results-sur-sem"><span class="toc-section-number">6.2</span> Full results SUR-SEM</a></li>
<li><a href="#full-results-sur-slm-iv" id="toc-full-results-sur-slm-iv"><span class="toc-section-number">6.3</span> Full results SUR-SLM-IV</a></li>
</ul></li>
</ul>
</div>

<div id="Intro" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>The main objective of this vignette is to present the results of the
estimation of spatial SUR models using three alternative tools: Two
<em>R</em>-packages, <strong>spsur</strong> <span class="citation">(<a href="#ref-MinguezJSS2022" role="doc-biblioref">Mínguez, López, and Mur
2022</a>; <a href="#ref-Lopez2020" role="doc-biblioref">López, Mı́nguez,
and Mur 2020</a>)</span> and <strong>spse</strong> <span class="citation">(<a href="#ref-PirasGitHub" role="doc-biblioref">Piras
2018</a>)</span> together with the <em>Python</em> spatial analysis
library <strong>PySAL</strong> available at <a href="https://pysal.org/">https://pysal.org/</a>. Three SUR models are
estimated in this vignette. The first one, is the baseline SUR-SIM
model, a SUR model without spatial effects. This model will be estimated
with <strong>spsur</strong> and <strong>PySAL</strong>. The second one
is the SUR-SEM model; that is, a SUR model including a spatial lag in
the errors. This model will be estimated by Maximum Likelihood <span class="citation">(<a href="#ref-Anselin1988a" role="doc-biblioref">Anselin 1988</a>)</span>, using the three
alternative tools. The last one is the SUR-SLM model, including a
spatial lag of the dependent variable, which will be estimated by the
Three Stage Least Squares (3SLS) algorithm <span class="citation">(<a href="#ref-Lopez2020" role="doc-biblioref">López, Mı́nguez, and Mur
2020</a>; <a href="#ref-Anselin2016" role="doc-biblioref">Anselin
2016</a>)</span>. This model will be estimated with
<strong>spsur</strong> and <strong>PySAL</strong>.</p>
<p>The comparison is performed on the <span class="citation">Baller et
al. (<a href="#ref-Baller2001" role="doc-biblioref">2001</a>)</span>
data set<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. This is a well-known dataset downloaded
from the GeoDa Data and Lab collection with information about homicide
rates in 3,085 continental US counties for four years (1960, 1970, 1980,
and 1990). The dataset includes a large number of socio-economic
characteristics for these counties. This dataset is available from the
<strong>spsur</strong> R-package with the name <em>NCOVR</em> and from
<strong>PySAL</strong> with the name of <em>NAT.dbf</em>.</p>
<p>The model selected to illustrate the results of the estimation is the
same as that included in the help area of <strong>PySAL</strong>.</p>
</div>
<div id="SUR-SIM" class="section level1" number="2">
<h1><span class="header-section-number">2</span> The SUR-SIM model</h1>
<p>This section considers the simplest case of the estimation of an SUR
model without spatial effects: SUR-SIM. The model specification is the
same as that which appears in the help of area of <strong>PySAL</strong>
and we reproduce it in the equation @ref(eq:ncovr):</p>
<span class="math display">\[\begin{equation}
\begin{array}{llc}
HR_{80} = \beta_{10} + PS_{80} \ \beta_{11} + UE_{80} \ \beta_{12} +
\epsilon_1 \\
HR_{90} = \beta_{20} + PS_{90} \ \beta_{21} + UE_{90} \ \beta_{22} +
\epsilon_2 \\
cov(\epsilon_i,\epsilon_j)=\sigma_{ij} \ ; \ i,j=1,2
\end{array}
(\#eq:ncovr)
\end{equation}\]</span>
<p>The <em>R</em> code to estimate equation @ref(eq:ncovr) with the
<strong>spsur</strong> package is:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;NCOVR&quot;</span>, <span class="at">package =</span> <span class="st">&quot;spsur&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>formula.spsur <span class="ot">&lt;-</span> HR80 <span class="sc">|</span> HR90 <span class="sc">~</span> PS80 <span class="sc">+</span> UE80 <span class="sc">|</span> PS90 <span class="sc">+</span> UE90</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>spsur.sim <span class="ot">&lt;-</span> <span class="fu">spsurml</span>(<span class="at">formula =</span> formula.spsur, <span class="at">data =</span> NCOVR.sf, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&quot;sim&quot;</span>, <span class="at">control =</span> control)</span></code></pre></div>
<p>The <em>Python</em> code to estimate equation @ref(eq:ncovr) with
<strong>PySAL</strong> is:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>db <span class="op">=</span> pysal.<span class="bu">open</span>(pysal.examples.get_path(<span class="st">&quot;NAT.dbf&quot;</span>),<span class="st">&#39;r&#39;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>y_var <span class="op">=</span> [<span class="st">&#39;HR80&#39;</span>,<span class="st">&#39;HR90&#39;</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>x_var <span class="op">=</span> [[<span class="st">&#39;PS80&#39;</span>,<span class="st">&#39;UE80&#39;</span>],[<span class="st">&#39;PS90&#39;</span>,<span class="st">&#39;UE90&#39;</span>]]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>bigy,bigX,bigyvars,bigXvars <span class="op">=</span> pysal.spreg.sur_utils.sur_dictxy(db,y_var,x_var)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> pysal.knnW_from_shapefile(pysal.examples.get_path(<span class="st">&quot;NAT.shp&quot;</span>), k <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>w.transform <span class="op">=</span> <span class="st">&#39;r&#39;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>pysal_sim <span class="op">=</span> SUR(bigy,bigX,w<span class="op">=</span>w,<span class="bu">iter</span><span class="op">=</span><span class="va">True</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                name_bigy<span class="op">=</span>bigyvars,name_bigX<span class="op">=</span>bigXvars,spat_diag<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                name_ds<span class="op">=</span><span class="st">&quot;nat&quot;</span>)</span></code></pre></div>
<p>Note that the <em>Python</em> code includes the definition of the
<span class="math inline">\(W\)</span> matrix. Following <span class="citation">Baller et al. (<a href="#ref-Baller2001" role="doc-biblioref">2001</a>)</span> we choose a <strong>W</strong>
matrix based on the k-nearest-neighbors, with <span class="math inline">\(k = 10\)</span>.</p>
<p>Table 2.1 shows the values of the coefficients and the standard error
(in parentheses). The full output of both codes is shown in the
Appendix. The main result is that no relevant differences are founded.
The results of the estimations are similar, both in terms of the
parameters and the standard errors, and only extremely small numerical
differences appears.</p>
<table>
<caption>
Table 2.1 Estimated coefficients and standard errors. SUR-SIM
</caption>
<thead>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{10}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{11}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{12}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{12}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{12}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{12}\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
spsur
</td>
<td style="text-align:center;">
5.1794
</td>
<td style="text-align:center;">
0.6775
</td>
<td style="text-align:center;">
0.2578
</td>
<td style="text-align:center;">
3.7811
</td>
<td style="text-align:center;">
1.0243
</td>
<td style="text-align:center;">
0.3614
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.2595)
</td>
<td style="text-align:center;">
(0.1219)
</td>
<td style="text-align:center;">
(0.0338)
</td>
<td style="text-align:center;">
(0.2531)
</td>
<td style="text-align:center;">
(0.1133)
</td>
<td style="text-align:center;">
(0.0340)
</td>
</tr>
<tr>
<td style="text-align:center;">
PySAL
</td>
<td style="text-align:center;">
5.1842
</td>
<td style="text-align:center;">
0.6776
</td>
<td style="text-align:center;">
0.2571
</td>
<td style="text-align:center;">
3.7973
</td>
<td style="text-align:center;">
1.0241
</td>
<td style="text-align:center;">
0.3590
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.2594)
</td>
<td style="text-align:center;">
(0.1219)
</td>
<td style="text-align:center;">
(0.0338)
</td>
<td style="text-align:center;">
(0.2531)
</td>
<td style="text-align:center;">
(0.1133)
</td>
<td style="text-align:center;">
(0.0340)
</td>
</tr>
</tbody>
</table>
</div>
<div id="estimation-of-sur-sem" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Estimation of
SUR-SEM</h1>
<p>This section presents the results of the estimation of the SUR-SEM
model by Maximum Likelihood with <strong>spsur</strong>,
<strong>spse</strong> and <strong>PySAL</strong>. The formal expression
of SUR-SEM includes a spatial structure in the residuals of the model
@ref(eq:ncovr),</p>
<span class="math display">\[\begin{equation}
\begin{array}{ll}
HR_{80} = \beta_{10} + PS_{80} \ \beta_{11} + UE_{80} \ \beta_{12} + u_1
\ ;  \  u_1 = \lambda_1 W u_1 + \epsilon_1 \\
HR_{90} = \beta_{20} + PS_{90} \ \beta_{21} + UE_{90} \ \beta_{22} + u_2
\ ;  \ u_2 = \lambda_2 W u_2 + \epsilon_2 \\
\end{array}
(\#eq:sur-sem)
\end{equation}\]</span>
<p>where <span class="math inline">\(W\)</span> is the <span class="math inline">\(N \times N\)</span> spatial weighting matrix and
<span class="math inline">\(\lambda_i\)</span> (i=1,2) are the
parameters of spatial dependence. The <span class="math inline">\(W\)</span> matrix has been previously defined in
the <strong>PySAL</strong> code using neighborhood criteria based on the
k-nearest-neighbors with k = 10. This <span class="math inline">\(W\)</span> matrix can be imported to the
<em>R</em> environment and transformed into an <em>listw</em> object.
The <span class="math inline">\(W\)</span> matrix has been standardized
in <strong>PySAL</strong>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>listw <span class="ot">&lt;-</span> <span class="fu">mat2listw</span>(<span class="fu">as.matrix</span>(<span class="fu">py_to_r</span>(py<span class="sc">$</span>w)<span class="sc">$</span>sparse))</span></code></pre></div>
<p>The <em>R</em> code to estimate the SUR-SEM model @ref(eq:sur-sem)
with <strong>spsur</strong> is:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>spsur.sem <span class="ot">&lt;-</span> <span class="fu">spsurml</span>(<span class="at">formula =</span> formula.spsur, <span class="at">data =</span> NCOVR.sf,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">listw =</span> listw , <span class="at">type =</span> <span class="st">&quot;sem&quot;</span>, <span class="at">control =</span> control)</span></code></pre></div>
<p>In order to estimate the same model with <strong>spse</strong>, the
<em>sf</em> object NCOVR.sf must be reordered to transform the data set
from a data frame into another one with a structure of panel data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">index_indiv =</span> <span class="fu">factor</span>(<span class="fu">cbind</span>(<span class="fu">paste0</span>(<span class="st">&quot;Indv_&quot;</span>,<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3085</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">each =</span> <span class="dv">2</span>)))),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1990</span>),<span class="dv">3085</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">HR =</span> <span class="fu">c</span>(<span class="fu">rbind</span>(NCOVR.sf<span class="sc">$</span>HR80,NCOVR.sf<span class="sc">$</span>HR90)),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">PS =</span> <span class="fu">c</span>(<span class="fu">rbind</span>(NCOVR.sf<span class="sc">$</span>PS80,NCOVR.sf<span class="sc">$</span>PS90)),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">UE =</span> <span class="fu">c</span>(<span class="fu">rbind</span>(NCOVR.sf<span class="sc">$</span>UE80,NCOVR.sf<span class="sc">$</span>UE90)))</span></code></pre></div>
<p>With this data frame, model @ref(eq:sur-sem) can be estimated with
<strong>spse</strong>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>eq <span class="ot">&lt;-</span> HR <span class="sc">~</span> PS <span class="sc">+</span> UE</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>formula.spse <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">tp1 =</span> eq, <span class="at">tp2 =</span> eq)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>spse.sem <span class="ot">&lt;-</span> <span class="fu">spseml</span>(formula.spse, <span class="at">data =</span> data,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">w =</span> listw, <span class="at">model =</span> <span class="st">&quot;error&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Finally, the <strong>PySAL</strong> code to estimate SUR-SEM model
@ref(eq:sur-sem) is:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spreg <span class="im">import</span> SURerrorML</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>pysal_sem <span class="op">=</span> SURerrorML(bigy,bigX,w<span class="op">=</span>w,name_bigy<span class="op">=</span>bigyvars,name_bigX<span class="op">=</span>bigXvars,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                       name_ds<span class="op">=</span><span class="st">&quot;NAT&quot;</span>,name_w<span class="op">=</span><span class="st">&quot;nat_queen&quot;</span>)</span></code></pre></div>
<p>Table 3.1 shows the coefficients and the standard errors obtained in
the estimation of equation @ref(eq:sur-sem) with the three alternatives.
The results are very similar, and only small differences appear when the
results of <strong>spse</strong> are compared with
<strong>spsur</strong> and <strong>PySAL</strong>. The use of different
optimization routines is a possible source of the these small numerical
differences. For example, the <strong>spsur</strong> optimizes the
concentrated Log-Likelihood with the <em>bobyqa()</em> from
<strong>minqa</strong> <span class="citation">(<a href="#ref-minqa" role="doc-biblioref">Bates et al. 2014</a>)</span> while
<strong>spse</strong> uses <em>nlminb()</em> from the
<strong>stats</strong> package <span class="citation">(<a href="#ref-stats" role="doc-biblioref">R Core Team 2020</a>)</span>. The
full output of both codes is shown in the Appendix.</p>
<table>
<caption>
Table 3.1 Estimated coefficients and standard errors. SUR-SEM
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{10}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{11}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{12}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{20}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{21}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{22}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\lambda_{1}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\lambda_{2}\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
spsur
</td>
<td style="text-align:center;">
3.9998
</td>
<td style="text-align:center;">
1.0185
</td>
<td style="text-align:center;">
0.4313
</td>
<td style="text-align:center;">
3.1256
</td>
<td style="text-align:center;">
1.1626
</td>
<td style="text-align:center;">
0.4532
</td>
<td style="text-align:center;">
0.6680
</td>
<td style="text-align:center;">
0.6252
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.4256)
</td>
<td style="text-align:center;">
(0.1414)
</td>
<td style="text-align:center;">
(0.0436)
</td>
<td style="text-align:center;">
(0.3753)
</td>
<td style="text-align:center;">
(0.1354)
</td>
<td style="text-align:center;">
(0.0408)
</td>
<td style="text-align:center;">
(0.0216)
</td>
<td style="text-align:center;">
(0.0233)
</td>
</tr>
<tr>
<td style="text-align:left;">
spse
</td>
<td style="text-align:center;">
4.0458
</td>
<td style="text-align:center;">
1.0090
</td>
<td style="text-align:center;">
0.4247
</td>
<td style="text-align:center;">
3.1730
</td>
<td style="text-align:center;">
1.1609
</td>
<td style="text-align:center;">
0.4462
</td>
<td style="text-align:center;">
0.6550
</td>
<td style="text-align:center;">
0.6245
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.4179)
</td>
<td style="text-align:center;">
(0.1414)
</td>
<td style="text-align:center;">
(0.0435)
</td>
<td style="text-align:center;">
(0.3754)
</td>
<td style="text-align:center;">
(0.1357)
</td>
<td style="text-align:center;">
(0.0408)
</td>
<td style="text-align:center;">
(0.0187)
</td>
<td style="text-align:center;">
(0.0197)
</td>
</tr>
<tr>
<td style="text-align:left;">
PySAL
</td>
<td style="text-align:center;">
3.9996
</td>
<td style="text-align:center;">
1.0186
</td>
<td style="text-align:center;">
0.4314
</td>
<td style="text-align:center;">
3.1253
</td>
<td style="text-align:center;">
1.1626
</td>
<td style="text-align:center;">
0.4533
</td>
<td style="text-align:center;">
0.6680
</td>
<td style="text-align:center;">
0.6252
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.4256)
</td>
<td style="text-align:center;">
(0.1414)
</td>
<td style="text-align:center;">
(0.0436)
</td>
<td style="text-align:center;">
(0.3753)
</td>
<td style="text-align:center;">
(0.1354)
</td>
<td style="text-align:center;">
(0.0408)
</td>
<td style="text-align:center;">
(NA)
</td>
<td style="text-align:center;">
(NA)
</td>
</tr>
</tbody>
</table>
</div>
<div id="estimation-of-sur-slm" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Estimation of
SUR-SLM</h1>
<p>The option to estimate an SUR-SLM model with the 3SLS algorithm <span class="citation">(<a href="#ref-Anselin2016" role="doc-biblioref">Anselin 2016</a>; <a href="#ref-Lopez2020" role="doc-biblioref">López, Mı́nguez, and Mur 2020</a>)</span> is
available with <strong>spsur</strong> and <strong>PySAL</strong>. The
specification of this model in our case is:</p>
<span class="math display">\[\begin{equation}
\begin{array}{ll}
HR_{80} = \ W HR_{80} \rho_1 + \beta_{10} + PS_{80} \ \beta_{11} +
UE_{80} \ \beta_{12} + \epsilon_1 \\
HR_{90} = \ W HR_{90} \rho_2 + \beta_{20} + PS_{90} \ \beta_{21} +
UE_{90} \ \beta_{22} + \epsilon_2 \\
\end{array}
(\#eq:sur-slm)
\end{equation}\]</span>
<p>where <span class="math inline">\(\rho_i\)</span> (i=1,2) are the
parameters of spatial dependence. The <em>R</em> code to estimate
SUR-SLM (@ref(eq:sur-slm)) using the 3SLS algorithm is:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>spsur.slm<span class="fl">.3</span>sls <span class="ot">&lt;-</span> <span class="fu">spsur3sls</span>(<span class="at">formula =</span> formula.spsur, <span class="at">data =</span> NCOVR.sf,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">listw =</span> listw , <span class="at">type =</span> <span class="st">&quot;slm&quot;</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>The code to estimate the equation (@ref(eq:sur-slm)) with
<strong>PySAL</strong> is,</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spreg <span class="im">import</span> SURlagIV</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>pysal_iv <span class="op">=</span> SURlagIV(bigy,bigX,w<span class="op">=</span>w,w_lags<span class="op">=</span><span class="dv">2</span>,name_bigy<span class="op">=</span>bigyvars,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                    name_bigX<span class="op">=</span>bigXvars,name_ds<span class="op">=</span><span class="st">&quot;NAT&quot;</span>,name_w<span class="op">=</span><span class="st">&quot;nat_queen&quot;</span>)</span></code></pre></div>
<p>Note that the instruments used by default with the function
<em>spsur3sls()</em> are the first two spatial lags of the independent
variables (see <span class="citation">López, Mı́nguez, and Mur (<a href="#ref-Lopez2020" role="doc-biblioref">2020</a>)</span>) while the
function <em>SURlagIV()</em> in <strong>PySAL</strong> considers only
the first one by default (see <span class="citation">Anselin (<a href="#ref-Anselin2016" role="doc-biblioref">2016</a>)</span>).
Therefore, to obtain equivalent results, it is necessary to include the
option <span class="math inline">\(w\_lags = 2\)</span> in the
<strong>PySAL</strong> code.</p>
<p>Table 4.1 shows the coefficients and standard error (in parentheses)
of the estimation with <strong>spsur</strong> and
<strong>PySAL</strong>. As in the case of the SUR-SEM estimation,
minimal differences are founded. The results are practically identical.
The full output of both codes is shown in the Appendix.</p>
<table>
<caption>
Table 4.1 Estimated coefficients and standard errors. SUR-SLM-IV
</caption>
<thead>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{10}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{11}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{12}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{20}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{21}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\beta_{22}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\rho_{1}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat\rho_{2}\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
spsur
</td>
<td style="text-align:center;">
3.6000
</td>
<td style="text-align:center;">
0.5932
</td>
<td style="text-align:center;">
0.2913
</td>
<td style="text-align:center;">
2.3915
</td>
<td style="text-align:center;">
0.8871
</td>
<td style="text-align:center;">
0.3626
</td>
<td style="text-align:center;">
0.1957
</td>
<td style="text-align:center;">
0.2230
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(1.7539)
</td>
<td style="text-align:center;">
(0.1687)
</td>
<td style="text-align:center;">
(0.0409)
</td>
<td style="text-align:center;">
(0.3649)
</td>
<td style="text-align:center;">
(0.1155)
</td>
<td style="text-align:center;">
(0.0417)
</td>
<td style="text-align:center;">
(0.2611)
</td>
<td style="text-align:center;">
(0.0727)
</td>
</tr>
<tr>
<td style="text-align:center;">
PySAL
</td>
<td style="text-align:center;">
3.6000
</td>
<td style="text-align:center;">
0.5932
</td>
<td style="text-align:center;">
0.2913
</td>
<td style="text-align:center;">
2.3915
</td>
<td style="text-align:center;">
0.8871
</td>
<td style="text-align:center;">
0.3626
</td>
<td style="text-align:center;">
0.1957
</td>
<td style="text-align:center;">
0.2230
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(1.7536)
</td>
<td style="text-align:center;">
(0.1687)
</td>
<td style="text-align:center;">
(0.0409)
</td>
<td style="text-align:center;">
(0.3648)
</td>
<td style="text-align:center;">
(0.1155)
</td>
<td style="text-align:center;">
(0.0417)
</td>
<td style="text-align:center;">
(0.2610)
</td>
<td style="text-align:center;">
(0.0727)
</td>
</tr>
</tbody>
</table>
</div>
<div id="conclusion" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Conclusion</h1>
<p>In this vignette, a numerical check to compare the results of several
spatial SUR models estimations is shown. Fortunately, some
functionalities of <strong>spsur</strong> are also available in the
<strong>spse</strong> package and also in <strong>PySAL</strong> so the
user can choose. The well-known data set <span class="citation">(<a href="#ref-Baller2001" role="doc-biblioref">Baller et al.
2001</a>)</span> is used with the objective of comparing the values of
the estimated coefficients and standard errors. The results confirm that
the three alternatives supply identical outputs with extremely small
numerical differences.</p>
</div>
<div id="Appendix" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Appendix</h1>
<div id="full-results-sur-sim" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Full results
SUR-SIM</h2>
<div id="spsur-output" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> spsur output</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(spsur.sim)</span></code></pre></div>
<pre><code>## Call:
## spsurml(formula = formula.spsur, data = NCOVR.sf, type = &quot;sim&quot;, 
##     control = control)
## 
##  
## Spatial SUR model type:  sim 
## 
## Equation  1 
##               Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)_1 5.179417   0.259455 19.9627 &lt; 2.2e-16 ***
## PS80_1        0.677534   0.121932  5.5567 2.865e-08 ***
## UE80_1        0.257775   0.033814  7.6233 2.846e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## R-squared: 0.02502 
##   Equation  2 
##               Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)_2 3.781120   0.253129  14.938 &lt; 2.2e-16 ***
## PS90_2        1.024287   0.113331   9.038 &lt; 2.2e-16 ***
## UE90_2        0.361394   0.034047  10.614 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## R-squared: 0.1099 
##   
## Variance-Covariance Matrix of inter-equation residuals:                  
##  45.43619 21.56823
##  21.56823 39.72187
## Correlation Matrix of inter-equation residuals:                    
##  1.0000000 0.5076902
##  0.5076902 1.0000000
## 
##  R-sq. pooled: 0.06654 
##  Breusch-Pagan: 795.9  p-value: (4.3e-175)</code></pre>
</div>
<div id="pysal-output" class="section level3" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> PySal output</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pysal_sim.summary)</span></code></pre></div>
<pre><code>## REGRESSION
## ----------
## SUMMARY OF OUTPUT: SEEMINGLY UNRELATED REGRESSIONS (SUR)
## --------------------------------------------------------
## Data set            :         nat
## Weights matrix      :     unknown
## Number of Equations :           2                Number of Observations:        3085
## Log likelihood (SUR):  -19860.068                Number of Iterations  :           3
## ----------
## 
## SUMMARY OF EQUATION 1
## ---------------------
## Dependent Variable  :        HR80                Number of Variables   :           3
## Mean dependent var  :      6.9276                Degrees of Freedom    :        3082
## S.D. dependent var  :      6.8251
## 
## ------------------------------------------------------------------------------------
##             Variable     Coefficient       Std.Error     z-Statistic     Probability
## ------------------------------------------------------------------------------------
##           Constant_1       5.1842323       0.2593924      19.9860602       0.0000000
##                 PS80       0.6775792       0.1219113       5.5579678       0.0000000
##                 UE80       0.2570650       0.0338051       7.6043173       0.0000000
## ------------------------------------------------------------------------------------
## 
## SUMMARY OF EQUATION 2
## ---------------------
## Dependent Variable  :        HR90                Number of Variables   :           3
## Mean dependent var  :      6.1829                Degrees of Freedom    :        3082
## S.D. dependent var  :      6.6403
## 
## ------------------------------------------------------------------------------------
##             Variable     Coefficient       Std.Error     z-Statistic     Probability
## ------------------------------------------------------------------------------------
##           Constant_2       3.7973181       0.2531089      15.0027035       0.0000000
##                 PS90       1.0241120       0.1133298       9.0365598       0.0000000
##                 UE90       0.3589567       0.0340440      10.5438928       0.0000000
## ------------------------------------------------------------------------------------
## 
## 
## REGRESSION DIAGNOSTICS
##                                      TEST         DF       VALUE           PROB
##                          LM test on Sigma         1      680.168           0.0000
##                          LR test on Sigma         1      854.181           0.0000
## 
## OTHER DIAGNOSTICS - CHOW TEST BETWEEN EQUATIONS
##                                 VARIABLES         DF       VALUE           PROB
##                    Constant_1, Constant_2         1       23.457           0.0000
##                                PS80, PS90         1        8.700           0.0032
##                                UE80, UE90         1        6.843           0.0089
## 
## DIAGNOSTICS FOR SPATIAL DEPENDENCE
## TEST                              DF       VALUE           PROB
## Lagrange Multiplier (error)       2        2278.632        0.0000
## Lagrange Multiplier (lag)         2        2153.976        0.0000
## 
## ERROR CORRELATION MATRIX
##   EQUATION 1  EQUATION 2
##     1.000000    0.507913
##     0.507913    1.000000
## ================================ END OF REPORT =====================================</code></pre>
</div>
</div>
<div id="full-results-sur-sem" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Full results
SUR-SEM</h2>
<div id="spsur-output-1" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> spsur output</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(spsur.sem)</span></code></pre></div>
<pre><code>## Call:
## spsurml(formula = formula.spsur, data = NCOVR.sf, listw = listw, 
##     type = &quot;sem&quot;, control = control)
## 
##  
## Spatial SUR model type:  sem 
## 
## Equation  1 
##               Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)_1 3.999783   0.425587  9.3983 &lt; 2.2e-16 ***
## PS80_1        1.018523   0.141382  7.2040 6.544e-13 ***
## UE80_1        0.431340   0.043645  9.8829 &lt; 2.2e-16 ***
## lambda_1      0.667989   0.021592 30.9374 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## R-squared: 0.3561 
##   Equation  2 
##               Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)_2 3.125570   0.375304  8.3281 &lt; 2.2e-16 ***
## PS90_2        1.162587   0.135392  8.5868 &lt; 2.2e-16 ***
## UE90_2        0.453225   0.040766 11.1178 &lt; 2.2e-16 ***
## lambda_2      0.625186   0.023276 26.8594 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## R-squared: 0.3724 
##   
## Variance-Covariance Matrix of inter-equation residuals:                    
##  30.711725  8.751191
##   8.751191 28.408108
## Correlation Matrix of inter-equation residuals:                    
##  1.0000000 0.2962743
##  0.2962743 1.0000000
## 
##  R-sq. pooled: 0.3658 
##  Breusch-Pagan: 270.8  p-value: (7.63e-61) 
##  LMM: 267.61  p-value: (3.76e-60)</code></pre>
</div>
<div id="spse-output" class="section level3" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> spse output</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(spse.sem)</span></code></pre></div>
<pre><code>## 
## Simultaneous Equations Model:
## 
## Call:
## spseml(formula = formula.spse, data = data, w = listw, quiet = TRUE, 
##     model = &quot;error&quot;)
##  
## Equation 1
##             Estimate Std.Error t value  Pr(&gt;|t|)    
## (Intercept) 4.045752  0.417886  9.6815 &lt; 2.2e-16 ***
## PS          1.009015  0.141429  7.1344 9.719e-13 ***
## UE          0.424679  0.043513  9.7598 &lt; 2.2e-16 ***
##  
## Spatial autocorrelation coefficient: 0.655 Pr(&gt;|t|) 0
## 
##  _______________________________________________________ 
##  
## Equation 2
##             Estimate Std.Error t value  Pr(&gt;|t|)    
## (Intercept) 3.172955  0.375401  8.4522 &lt; 2.2e-16 ***
## PS          1.160865  0.135689  8.5553 &lt; 2.2e-16 ***
## UE          0.446204  0.040767 10.9452 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
##  
## Spatial autocorrelation coefficient: 0.6245 Pr(&gt;|t|) 0
## 
##  _______________________________________________________</code></pre>
</div>
<div id="pysal-output-1" class="section level3" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> PySal output</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pysal_sem.summary)</span></code></pre></div>
<pre><code>## REGRESSION
## ----------
## SUMMARY OF OUTPUT: SEEMINGLY UNRELATED REGRESSIONS (SUR) - ML SPATIAL ERROR MODEL
## ---------------------------------------------------------------------------------
## Data set            :         NAT
## Weights matrix      :   nat_queen
## Number of Equations :           2                Number of Observations:        3085
## Log likelihood (SUR):  -19860.068
## Log likel. (error)  :  -19344.228                Log likel. (SUR error):  -19215.933
## ----------
## 
## SUMMARY OF EQUATION 1
## ---------------------
## Dependent Variable  :        HR80                Number of Variables   :           3
## Mean dependent var  :      6.9276                Degrees of Freedom    :        3082
## S.D. dependent var  :      6.8251
## 
## ------------------------------------------------------------------------------------
##             Variable     Coefficient       Std.Error     z-Statistic     Probability
## ------------------------------------------------------------------------------------
##           Constant_1       3.9995930       0.4255575       9.3984776       0.0000000
##                 PS80       1.0185647       0.1413612       7.2054039       0.0000000
##                 UE80       0.4313678       0.0436389       9.8849267       0.0000000
##             lambda_1       0.6680433    
## ------------------------------------------------------------------------------------
## 
## SUMMARY OF EQUATION 2
## ---------------------
## Dependent Variable  :        HR90                Number of Variables   :           3
## Mean dependent var  :      6.1829                Degrees of Freedom    :        3082
## S.D. dependent var  :      6.6403
## 
## ------------------------------------------------------------------------------------
##             Variable     Coefficient       Std.Error     z-Statistic     Probability
## ------------------------------------------------------------------------------------
##           Constant_2       3.1253307       0.3752706       8.3282066       0.0000000
##                 PS90       1.1625986       0.1353719       8.5881796       0.0000000
##                 UE90       0.4532595       0.0407597      11.1202836       0.0000000
##             lambda_2       0.6252406    
## ------------------------------------------------------------------------------------
## 
## 
## REGRESSION DIAGNOSTICS
##                                      TEST         DF       VALUE           PROB
##                          LR test on Sigma         1      256.591           0.0000
## 
## OTHER DIAGNOSTICS - CHOW TEST BETWEEN EQUATIONS
##                                 VARIABLES         DF       VALUE           PROB
##                    Constant_1, Constant_2         1        3.111           0.0778
##                                PS80, PS90         1        0.767           0.3812
##                                UE80, UE90         1        0.165           0.6847
## 
## ERROR CORRELATION MATRIX
##   EQUATION 1  EQUATION 2
##     1.000000    0.296257
##     0.296257    1.000000
## ================================ END OF REPORT =====================================</code></pre>
</div>
</div>
<div id="full-results-sur-slm-iv" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Full results
SUR-SLM-IV</h2>
<div id="spsur-output-2" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> spsur output</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(spsur.slm<span class="fl">.3</span>sls)</span></code></pre></div>
<pre><code>## Call:
## spsur3sls(formula = formula.spsur, data = NCOVR.sf, listw = listw, 
##     type = &quot;slm&quot;, trace = FALSE)
## 
##  
## Spatial SUR model type:  slm 
## 
## Equation  1 
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)_1 3.600033   1.753859  2.0526 0.040150 *  
## PS80_1        0.593229   0.168744  3.5156 0.000442 ***
## UE80_1        0.291323   0.040887  7.1250 1.16e-12 ***
## rho_1         0.195653   0.261078  0.7494 0.453643    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## R-squared: 0.1995 
##   Equation  2 
##               Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)_2 2.391472   0.364855  6.5546 6.033e-11 ***
## PS90_2        0.887118   0.115519  7.6794 1.848e-14 ***
## UE90_2        0.362642   0.041738  8.6885 &lt; 2.2e-16 ***
## rho_2         0.222994   0.072671  3.0686   0.00216 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## R-squared: 0.2807 
##   
## Variance-Covariance Matrix of inter-equation residuals:                  
##  59.15973 21.01769
##  21.01769 34.68056
## Correlation Matrix of inter-equation residuals:                    
##  1.0000000 0.4397986
##  0.4397986 1.0000000
## 
##  R-sq. pooled: 0.2385 
##  Breusch-Pagan: 664.2  p-value: (1.8e-146)</code></pre>
</div>
<div id="pysal-output-2" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> PySal output</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pysal_iv.summary)</span></code></pre></div>
<pre><code>## REGRESSION
## ----------
## SUMMARY OF OUTPUT: SEEMINGLY UNRELATED REGRESSIONS (SUR) - SPATIAL LAG MODEL
## ----------------------------------------------------------------------------
## Data set            :         NAT
## Weights matrix      :   nat_queen
## Number of Equations :           2                Number of Observations:        3085
## ----------
## 
## SUMMARY OF EQUATION 1
## ---------------------
## Dependent Variable  :        HR80                Number of Variables   :           4
## Mean dependent var  :      6.9276                Degrees of Freedom    :        3081
## S.D. dependent var  :      6.8251
## 
## ------------------------------------------------------------------------------------
##             Variable     Coefficient       Std.Error     z-Statistic     Probability
## ------------------------------------------------------------------------------------
##           Constant_1       3.6000333       1.7535743       2.0529688       0.0400756
##                 PS80       0.5932292       0.1687164       3.5161321       0.0004379
##                 UE80       0.2913228       0.0408809       7.1261406       0.0000000
##               W_HR80       0.1956528       0.2610360       0.7495244       0.4535412
## ------------------------------------------------------------------------------------
## Instrumented: W_HR80
## Instruments: WW_PS80, WW_UE80, W_PS80, W_UE80
## 
## SUMMARY OF EQUATION 2
## ---------------------
## Dependent Variable  :        HR90                Number of Variables   :           4
## Mean dependent var  :      6.1829                Degrees of Freedom    :        3081
## S.D. dependent var  :      6.6403
## 
## ------------------------------------------------------------------------------------
##             Variable     Coefficient       Std.Error     z-Statistic     Probability
## ------------------------------------------------------------------------------------
##           Constant_2       2.3914725       0.3647963       6.5556384       0.0000000
##                 PS90       0.8871183       0.1155004       7.6806495       0.0000000
##                 UE90       0.3626418       0.0417315       8.6898895       0.0000000
##               W_HR90       0.2229941       0.0726587       3.0690610       0.0021473
## ------------------------------------------------------------------------------------
## Instrumented: W_HR90
## Instruments: WW_PS90, WW_UE90, W_PS90, W_UE90
## 
## 
## OTHER DIAGNOSTICS - CHOW TEST BETWEEN EQUATIONS
##                                 VARIABLES         DF       VALUE           PROB
##                    Constant_1, Constant_2         1        0.496           0.4811
##                                PS80, PS90         1        3.288           0.0698
##                                UE80, UE90         1        1.945           0.1631
##                            W_HR80, W_HR90         1        0.011           0.9147
## 
## ERROR CORRELATION MATRIX
##   EQUATION 1  EQUATION 2
##     1.000000    0.464012
##     0.464012    1.000000
## ================================ END OF REPORT =====================================</code></pre>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Anselin1988a" class="csl-entry">
Anselin, Luc. 1988. <em>Spatial Econometrics: Methods and Models</em>.
Studies in Operational Regional Science. Dordrecht: Kluwer Academic
Publishers.
</div>
<div id="ref-Anselin2016" class="csl-entry">
———. 2016. <span>“Estimation and Testing in the Spatial Seemingly
Unrelated Regression (SUR).”</span> Geoda Center for Geospatial
Analysis; Computation, Arizona State University. Working Paper 2016-01.
</div>
<div id="ref-Baller2001" class="csl-entry">
Baller, Robert D, Luc Anselin, Steven F Messner, Glenn Deane, and
Darnell F Hawkins. 2001. <span>“Structural Covariates of US County
Homicide Rates: Incorporating Spatial Effects.”</span>
<em>Criminology</em> 39 (3): 561–88.
</div>
<div id="ref-minqa" class="csl-entry">
Bates, Douglas, Katharine M. Mullen, John C. Nash, and Ravi Varadhan.
2014. <em><span class="nocase">m</span>inqa:
<span>D</span>erivative-Free Optimization Algorithms by Quadratic
Approximation</em>. <a href="https://CRAN.R-project.org/package=minqa">https://CRAN.R-project.org/package=minqa</a>.
</div>
<div id="ref-Lopez2020" class="csl-entry">
López, Fernando A, Román Mı́nguez, and Jesús Mur. 2020.
<span>“<span>ML</span> Versus <span>IV</span> Estimates of Spatial SUR
Models: Evidence from the Case of Airbnb in Madrid Urban Area.”</span>
<em>The Annals of Regional Science</em> 64 (2): 313–47. <a href="https://doi.org/10.1007/s00168-019-00914-1">https://doi.org/10.1007/s00168-019-00914-1</a>.
</div>
<div id="ref-MinguezJSS2022" class="csl-entry">
Mínguez, Román, Fernando A. López, and Jesús Mur. 2022. <span>“<span class="nocase">spsur</span>: An <span>R</span> Package for Dealing with
Spatial Seemingly Unrelated Regression Models.”</span> <em>Journal of
Statistical Software</em> 104 (11): 1–43. <a href="https://doi.org/10.18637/jss.v104.i11">https://doi.org/10.18637/jss.v104.i11</a>.
</div>
<div id="ref-PirasGitHub" class="csl-entry">
Piras, Gianfranco. 2018. <span>“<span class="nocase">s</span>pse:
Spatial Simultaneous Equations and Spatial SUR Model.”</span> <a href="https://github.com/gpiras">https://github.com/gpiras</a>.
</div>
<div id="ref-stats" class="csl-entry">
R Core Team. 2020. <em>R: <span>A</span> <span>L</span>anguage and
<span>E</span>nvironment for <span>S</span>tatistical
<span>C</span>omputing</em>. Vienna, Austria: R Foundation for
Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
</div>
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>see <a href="https://geodacenter.github.io/data-and-lab/ncovr/">GeoDa</a> for
more details about the database<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
